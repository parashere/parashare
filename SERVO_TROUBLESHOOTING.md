# サーボモーター制御トラブルシューティングガイド

## 現在の状況
サーボが動かない問題の診断と解決方法

## 確認項目

### 1. ハードウェア接続
- [ ] サーボモーターがGPIOピン13に正しく接続されているか
- [ ] 電源供給（5V）が適切に行われているか
- [ ] GND（グランド）が正しく接続されているか
- [ ] ケーブルに断線がないか

### 2. ソフトウェア環境
- [ ] gpiozeroライブラリがインストールされているか
- [ ] pigpio デーモンが実行されているか（必要に応じて）
- [ ] Raspberry Piの場合、GPIO権限があるか

### 3. 動作確認手順

#### Step 1: 基本テスト
1. `/servo-test/` ページにアクセス
2. 「状態確認」ボタンをクリック
3. 以下を確認：
   - サーボ利用可能: はい
   - サーボ初期化済み: はい

#### Step 2: サーボテスト
1. 「サーボテスト」ボタンをクリック
2. サーボが以下の順序で動作するか確認：
   - 中央位置 (0.0)
   - 右端位置 (1.0) 
   - 左端位置 (-1.0)
   - 中央位置に復帰 (0.0)

#### Step 3: ゲート制御テスト
1. 「ゲートを開く」ボタンをクリック
2. サーボが右端 (1.0) に移動することを確認
3. 「ゲートを閉じる」ボタンをクリック  
4. サーボが左端 (-1.0) に移動することを確認

## トラブルシューティング

### 問題: "gpiozero not available"
**解決方法:**
```bash
pip install gpiozero
```

### 問題: サーボが初期化されない
**確認事項:**
- GPIO権限の確認
- 配線の確認
- 電源供給の確認

**解決方法:**
```bash
sudo raspi-config
# Interfacing Options > SSH/I2C/SPI/etc を有効化
```

### 問題: サーボが動くが期待通りでない
**確認事項:**
- PWM周波数の設定
- サーボの仕様（制御信号の範囲）
- 電源の容量

### 問題: シミュレーションモードで動作している
**現在の状態:** 開発環境ではシミュレーションモードで動作
**実機での確認:** Raspberry Pi環境で実際のハードウェアをテスト

## デバッグ用コマンド

### ターミナルでの直接テスト
```python
# Python対話モードで実行
from gpiozero import Servo
from time import sleep

servo = Servo(13)
servo.value = 1.0  # 右端
sleep(2)
servo.value = -1.0  # 左端
sleep(2)
servo.value = 0.0  # 中央
```

### ログ確認
Django開発サーバーのコンソール出力を確認:
- ✓ 成功メッセージ
- ❌ エラーメッセージ
- 🎭 シミュレーションメッセージ

## 実装状況
- [x] サーボ制御クラス
- [x] API エンドポイント
- [x] Webインターフェース
- [x] エラーハンドリング
- [x] デバッグ機能
- [x] テスト機能
